repeat wait() until game:IsLoaded()

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local VirtualUser = game:GetService("VirtualUser")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- üîÑ Ch·∫∑n AFK
LocalPlayer.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

-- üè¥ T·ª± ƒë·ªông ch·ªçn H·∫£i T·∫∑c khi v√†o game
if game.PlaceId == 2753915549 or game.PlaceId == 4442272183 or game.PlaceId == 7449423635 then
    local args = { [1] = "SetTeam", [2] = "Pirates" }
    ReplicatedStorage.Remotes.CommF_:InvokeServer(unpack(args))
    wait(1)
    ReplicatedStorage.Remotes.CommF_:InvokeServer("TeleportToSpawn")
end

-- üîç T√¨m tr√°i √°c qu·ª∑ nhanh h∆°n
local function FindFruits()
    for _, fruit in pairs(game.Workspace:GetChildren()) do
        if fruit:IsA("Tool") and string.find(fruit.Name, "Fruit") then
            return fruit
        end
    end
    return nil
end

-- üìç D·ªãch chuy·ªÉn ƒë·∫øn tr√°i
local function TeleportToPosition(position)
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = position
    end
end

-- ‚úÖ L∆∞u tr·ªØ tr√°i v√†o kho
local function StoreFruit(fruitName)
    ReplicatedStorage.Remotes.CommF_:InvokeServer("StoreFruit", fruitName)
    print("‚úÖ ƒê√£ l∆∞u tr·ªØ: " .. fruitName)
end

-- üåê **T√¨m Server c√≥ tr√°i √°c qu·ª∑ nhanh h∆°n**
local function FastFindServerWithFruit()
    print("üîç ƒêang t√¨m server c√≥ tr√°i √°c qu·ª∑...")
    
    local bestServer = nil
    local servers = HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/2753915549/servers/Public?sortOrder=Asc&limit=100")).data

    for _, server in ipairs(servers) do
        if server.playing < server.maxPlayers then
            print("üõ†Ô∏è Ki·ªÉm tra nhanh server: " .. server.id)
            local success, response = pcall(function()
                return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/2753915549/servers/Public/" .. server.id))
            end)
            
            if success and response then
                if response.hasFruit then -- üî• Ki·ªÉm tra nhanh n·∫øu server c√≥ fruit
                    bestServer = server.id
                    break
                end
            end
        end
    end

    if bestServer then
        print("üçè Server c√≥ tr√°i! ƒêang v√†o...")
        TeleportService:TeleportToPlaceInstance(game.PlaceId, bestServer, LocalPlayer)
    else
        print("üö´ Kh√¥ng t√¨m th·∫•y server c√≥ tr√°i! Th·ª≠ l·∫°i sau.")
    end
end

-- üîÅ **TƒÉng t·ªëc t√¨m & nh·∫∑t tr√°i**
while true do
    local fruit = FindFruits()
    if fruit then
        print("üçè ƒê√£ t√¨m th·∫•y tr√°i √°c qu·ª∑! ƒêang nh·∫∑t...")
        TeleportToPosition(fruit.Handle.CFrame)
        wait(1)

        -- üèÜ Nh·∫∑t tr√°i & l∆∞u v√†o kho
        LocalPlayer.Character.Humanoid:EquipTool(fruit)
        wait(1)
        StoreFruit(fruit.Name)

        -- ‚è≥ Chuy·ªÉn server m·ªõi nhanh h∆°n
        wait(3)
        FastFindServerWithFruit()
    else
        print("‚ùå Kh√¥ng c√≥ tr√°i √°c qu·ª∑! T√¨m server nhanh h∆°n...")
        FastFindServerWithFruit()
    end
end
